(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n){var r=e.data,o=e.handleCardClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=r.name,this._link=r.link,this._cardSelector=n,this._handleCardClick=o}var n,r;return n=t,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}},{key:"_handleLikeClick",value:function(){this._card.querySelector(".card__like").classList.toggle("card__like_active")}},{key:"_handleRemoveClick",value:function(){this._card.remove()}},{key:"_setEventListeners",value:function(){var e=this;this._card.querySelector(".card__img").addEventListener("click",(function(){e._handleCardClick(e._name,e._link)})),this._card.querySelector(".card__like").addEventListener("click",(function(){e._handleLikeClick()})),this._card.querySelector(".card__delete").addEventListener("click",(function(){e._handleRemoveClick()}))}},{key:"createCard",value:function(){return this._card=this._getTemplate(),this._imgCard=this._card.querySelector(".card__img"),this._imgCard.alt=this._name,this._imgCard.src=this._link,this._card.querySelector(".card__name").textContent=this._name,this._setEventListeners(),this._card}}])&&e(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var r=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"_showInputError",(function(e,t){r._errorElement=r._formElement.querySelector(".".concat(e.id,"-error")),r._buttonSave=r._formElement.querySelector(r._submitButtonSelector),r._buttonSave.classList.add(r._inactiveButtonClass),e.classList.add(r._inputErrorClass),r._errorElement.textContent=t,r._errorElement.classList.add(r._errorClass)})),this._popup=n,this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}var t,r;return t=e,(r=[{key:"_hideInputError",value:function(e){this._errorElement=this._formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this._inputErrorClass),this._errorElement.textContent="",this._errorElement.classList.remove(this._errorClass)}},{key:"_hasInvalidInput",value:function(){return this._inputItemsList.some((function(e){return!e.validity.valid}))}},{key:"_changeButtonState",value:function(){this._hasInvalidInput(this._inputItemsList)?(this._buttonSave.classList.add(this._inactiveButtonClass),this._buttonSave.disabled=!0):(this._buttonSave.classList.remove(this._inactiveButtonClass),this._buttonSave.disabled=!1)}},{key:"_isValid",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_handleInputChange",value:function(){var e=this;this._inputItemsList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonSave=this._formElement.querySelector(this._submitButtonSelector),this._inputItemsList.forEach((function(t){t.addEventListener("input",(function(n){n.preventDefault(),e._isValid(t),e._changeButtonState()}))}))}},{key:"_handleSubmitForm",value:function(){this._formElement=this._popup.querySelector(this._formSelector),this._formElement.addEventListener("submit",(function(e){e.preventDefault()}))}},{key:"_setEventListeners",value:function(){this._handleSubmitForm(),this._handleInputChange()}},{key:"enableValidation",value:function(){this._setEventListeners(),this._changeButtonState()}},{key:"resetValidation",value:function(){var e=this;this._changeButtonState(),this._inputItemsList.forEach((function(t){e._hideInputError(t)}))}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),o={formSelector:".form",inputSelector:".form__item",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_disabled",inputErrorClass:"form__item_type_error",errorClass:"form__item-error_active"};function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"_clickHandler",(function(e){e.target.classList.contains("pop-up_opened")&&n.close()})),c(this,"_handleEscClose",(function(e){n._popup.classList.contains("pop-up_opened")&&"Escape"===e.key&&n.close()})),this._popup=document.querySelector(t),this._closeButton=this._popup.querySelector(".pop-up__close-button")}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("pop-up_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("pop-up_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var e=this;this._closeButton.addEventListener("click",(function(){e.close()})),this._popup.addEventListener("click",this._clickHandler)}}])&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function p(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=h(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},d.apply(this,arguments)}function h(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(n);if(r){var o=y(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return p(this,e)});function i(e){var t,n,r,a,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),u=function(e,r){n._popupImage.src=r,n._popupImage.alt=e,n._popupImageLabel.textContent=e,d((t=_(n),y(i.prototype)),"open",t).call(t)},(a="open")in(r=_(n=o.call(this,e)))?Object.defineProperty(r,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):r.open=u,n._popupImage=n._popup.querySelector(".pop-up__image"),n._popupImageLabel=n._popup.querySelector(".pop-up__label"),n}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(s);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function k(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){return E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=w(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},E.apply(this,arguments)}function w(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(r);if(o){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return k(this,e)});function a(e,t){var n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),O(S(r=i.call(this,e)),"_getInputValues",(function(){var e={};return r._inputList.forEach((function(t){e[t.name]=t.value})),e})),O(S(r),"setInputValues",(function(e){r._inputList.forEach((function(t){t.value=e[t.name]}))})),O(S(r),"setEventListeners",(function(){r._form.addEventListener("submit",(function(e){e.preventDefault(),r._handleFormSubmit(r._getInputValues())})),E((n=S(r),C(a.prototype)),"setEventListeners",n).call(n)})),r._handleFormSubmit=t,r._form=r._popup.querySelector(".form"),r._inputList=r._form.querySelectorAll(".form__item"),r}return t=a,(n=[{key:"close",value:function(){this._form.reset(),E(C(a.prototype),"close",this).call(this)}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(s);function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t&&j(e.prototype,t),n&&j(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=P((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),I(this,"getUserInfo",(function(){return{name:r._fieldName.textContent,description:r._fieldDescriptions.textContent}})),I(this,"setUserInfo",(function(e){var t=e.name,n=e.description;r._fieldName.textContent=t,r._fieldDescriptions.textContent=n})),this._fieldName=document.querySelector(t),this._fieldDescriptions=document.querySelector(n)})),B=document.querySelector(".profile__info").querySelector(".profile__edit-button"),R=document.querySelector(".profile__add-button"),T=document.querySelector(".galary").querySelector(".galary__cards-list"),x=document.querySelector("#profileEditPopup"),V=document.querySelector("#cardAddPopup"),D=new r(o,x),A=new r(o,V),F=new q(".profile__name",".profile__description"),N=function(e){return new t({data:e,handleCardClick:function(e,t){H.open(e,t)}},"#card").createCard()},U=new L("#profileEditPopup",(function(e){F.setUserInfo(e),U.close()}));U.setEventListeners();var H=new m("#imagePopup");H.setEventListeners();var M=new L("#cardAddPopup",(function(e){z.addItem(N(e)),M.close()}));M.setEventListeners();var z=new a({items:[{name:"Таганай",link:"https://mesto.kpreis.ru/images/taganay.jpeg"},{name:"Двуглавая сопка",link:"https://mesto.kpreis.ru/images/dvuglavaya-sopka.jpeg"},{name:"Откликной Гребень",link:"https://mesto.kpreis.ru/images/otkliknoy-greben.jpeg"},{name:"Круглица",link:"https://mesto.kpreis.ru/images/kruglitsa.webp"},{name:"Большая Каменная Река",link:"https://mesto.kpreis.ru/images/kamennaya-reka.jpeg"},{name:"Метеостанция",link:"https://mesto.kpreis.ru/images/meteostanciya-taganay.jpeg"}],renderer:function(e){T.append(N(e))}},".galary__cards-list");z.renderItems(),R.addEventListener("click",(function(){M.open(),A.resetValidation()})),B.addEventListener("click",(function(){U.open(),U.setInputValues(F.getUserInfo()),D.resetValidation()})),D.enableValidation(),A.enableValidation()})();